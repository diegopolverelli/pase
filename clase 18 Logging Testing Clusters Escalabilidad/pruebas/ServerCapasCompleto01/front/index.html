<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Pedidos:</h1>
    <div id="divPedidos"></div>
    <button id="btnPedidos">Pedidos</button>

    <script>
        let divPedidos=document.getElementById('divPedidos')
        let btnPedidos=document.getElementById('btnPedidos')

        btnPedidos.addEventListener('click',async(e)=>{
            e.preventDefault()

            let respuesta=await fetch('http://localhost:3000/api/ordenes')
            let ordenes=await respuesta.json()

            ordenes.dato.forEach(o=>{
                let numeroOrden=document.createElement('p')
                numeroOrden.innerHTML=o.numeroOrden||o._id
                let usuario=document.createElement('p')
                usuario.innerHTML=o.usuario.nombre
                let negocio=document.createElement('p')
                negocio.innerHTML=`${o.negocio.nombre} - Domicilio: ${o.negocio.domicilio||''}`

                let orden=document.createElement('div')
                orden.appendChild(numeroOrden)
                orden.appendChild(usuario)
                orden.appendChild(negocio)
                
                let pedido=document.createElement('ul')
                o.productos.forEach(p=>{
                    let producto=document.createElement('li')
                    producto.innerHTML=`${p.descrip}     cantidad: ${p.cantidad}       precio: ${p.precio}`
                    pedido.appendChild(producto)
                })
                orden.appendChild(pedido)
                
                orden.appendChild(document.createElement('br'))
                orden.appendChild(document.createElement('hr'))
                
                divPedidos.appendChild(orden)

            })

            console.log(ordenes)
        })
    </script>

</body>

</html>